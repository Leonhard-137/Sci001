目前的状况是，我可以使用PyROA以及后续的改装，把SED拟合完成。但是其结果与论文结果相差很多，目前发现了这些端倪：
1. PyROA拟合Lc的结果其实并不算优秀，只是还行。SV、B和z波段的拟合结果不太好，右侧时间延迟的分布也很奇怪。我并不十分清楚Pyroa内部是如何拟合数据的，这或许需要我检查bug。另外，为了节省时间我给Pyroa的walker以及迭代次数其实并不多。
![[Figure_100.png]]

2. Flux-Flux分析的结果：
![[Mrk142_fluxflux.pdf]]
看这个结果就可以很容易发现问题，其实这个xt和flux的拟合效果很差呀，W2基本上完全偏离了拟合，我不知道Pyroa是怎么拟合得到结果的，线性部分未免也太差了？图像绘制部分斜率有的高有的低，这或许对后面SED图像的异常有影响。
3. 现在看SED拟合，论文里面把前两个波段的结果掐掉了，我想是因为，论文的结果W2和M2波段的零点最大，且十分接近，这样他们的gal都会十分接近于0，而其他的gal是明显不为0的，如果像我这样把全部的gal都画出来，就会出现类似我图中W1的情况，没必要画出来。
![[Mrk142_SED.pdf]]
4. 我还注意到一个现象，拟合结果斜率（Power-law）的偏差其实并不高，但是截距的偏差很大，很奇怪，应该是因为数据的弥散太大了。
![[Mrk142_powerlaw_fit.pdf]]
整体来说，我认为可能是flux-flux分析中的线性拟合没考虑误差或者是有什么别的缺陷所造成的，Flux-Xt拟合不到位的问题，进一步致使flux_gal以及$\Delta Flux$计算的错误。当然它源代码可能xt-Flux绘图直接用的mcmc拟合参数，如果是这样的花，那只能说mcmc拟合并不到位，或许是我参数给少了。
接下来，我想先排查Pyroa里面FLux-xt图是怎么画的，如果是直接利用mcmc参数，就只能说明mcmc拟合的结果很差，那就只能多给一点参数了。

---
可能破案了，我排查了xt-flux的计算方法，正如我所料是使用mcmc拟合出来的参数。然后我使用了原始Pyroa里面的后检验代码，排除了一些bug之后，绘制了收敛图，发现给的样本参数数量不足，马尔科夫链没有收敛。
当然我现在不能笃定说收敛之后就可以得到与论文相近的答案，但是起码是个好消息，有很大可能。
不过现在新的难题出现了，我要拟合这个过程的话，需要很强的算力作为支撑，我现在的小参数都要运行十五分钟，那足以让mcmc收敛的话起码要一个小时？此外，我有十多个数据，这样的话，起码要跑半天，再加上其他地方也要用mcmc，这就奔着20h+去了，有点可怕。
当然我也有一点解决的方法，改原始模型，把拟合时间延迟的部分删掉，直接用iccf的结果，这样可以省略掉三分之一的参数，需要七八个小时，好像也不少啊哈哈哈。
另外要考虑的就是，我现在还是要计算哈勃常数。这篇论文复现成功后，还是有核内消光和最终的哈勃常数计算要做。当然我现在怀疑核内消光是不是有用，因为我感觉只要符合powerlaw就行了吧？还要看后续的研究。